<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>単語表示</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 30px;
      user-select: none;
    }
    #text {
      font-size: 2rem;
      margin-top: 50px;
    }
    input[type="number"] {
      font-size: 1.2rem;
      padding: 5px;
      width: 80px;
    }
    button {
      font-size: 1.2rem;
      padding: 5px 10px;
      margin-left: 10px;
    }
  </style>
</head>
<body>
  <h1>単語リスト</h1>
  <div onclick="event.stopPropagation();">
    番号指定：
    <input type="number" id="jumpNumber" min="1">
    <button onclick="jumpToNumber(event)">ジャンプ</button>
  </div>

  <div id="text" onclick="changeText()">読み込み中...</div>

  <script>
    let entries = []; // [{number: 1, word: 'follow', meaning: '～の後に続く、～に従う'}]
    let index = 0;
    let subIndex = 0; // 0:番号, 1:単語, 2:意味

    async function loadTexts() {
      const res = await fetch('texts.txt');
      const content = await res.text();

      entries = content
        .split('\n')
        .map(line => line.trim())
        .filter(line => line !== '')
        .map(line => {
          const parts = line.split(/\s+/); // 空白・タブ対応
          return {
            number: parseInt(parts[0]),
            word: parts[1],
            meaning: parts.slice(2).join(' ')
          };
        });

      if (entries.length > 0) {
        index = 0;
        subIndex = 0;
        showText();
      } else {
        document.getElementById("text").textContent = "表示する単語がありません";
      }
    }

    function showText() {
      if (entries.length === 0) return;

      const entry = entries[index];
      let display = "";

      switch (subIndex) {
        case 0:
          display = `${entry.number}.`;
          break;
        case 1:
          display = entry.word;
          break;
        case 2:
          display = entry.meaning;
          break;
      }

      document.getElementById("text").textContent = display;
    }

    function changeText() {
      if (entries.length === 0) return;

      subIndex++;
      if (subIndex > 2) {
        subIndex = 0;
        index = (index + 1) % entries.length;
      }
      showText();
    }

    function jumpToNumber(event) {
      event.stopPropagation(); // bodyのタップ無効化
      const num = parseInt(document.getElementById("jumpNumber").value);
      const foundIndex = entries.findIndex(e => e.number === num);
      if (foundIndex !== -1) {
        index = foundIndex;
        subIndex = 0;
        showText();
      } else {
        alert("その番号は見つかりませんでした");
      }
    }

    loadTexts();
  </script>
</body>
</html>
